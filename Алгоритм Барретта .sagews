︠a80fc9d5-ad1a-4caa-9015-62f03621b1bes︠
import numpy as np

def numsys(x,b):
    x1=x
    A=[]
    while x1>0:
        A.append(x1%b)
        x1=x1 // b
    A.reverse()
    return A

m=37
x=436
b=6
def Barrett(x,m,b):
    #ВХОД (переводим числа в b-чную систему счисления)
    m1=np.array(numsys(m,b))
    k=len(m1)
    m1=int("".join(map(str, m1)))
    x1=np.array(numsys(x,b))
    x1=int("".join(map(str, x1)))
    z=floor(pow(b,2*k)/m1)

    print 'Основание b = ',b
    print 'Модуль m по основани b: ', m1
    print 'Число x по основанию b: ', x1
    print 'z = [b^2k / m] = ', z

    q = floor((floor(x1/pow(b,k-1))*z)/pow(b,k+1))
    r1 = x1 % pow(b,k+1)
    r2 = (q*m1) % pow(b,k+1)
    if r1 >= r2:
        r = r1-r2
    else:
        r=pow(b,k+1) + r1 - r2
    while r >= m1:
        r = r-m1

    print
    print 'r = x (mod m) =',x1,'(mod',m1,') =', r


%time Barrett(43123^150,37164^16, 2^12)
︡c8946967-83ae-4faf-b7c2-b118f0295d84︡{"stdout":"Основание b =  4096\nМодуль m по основани b:  7202629322971168209199619831696273371024021461138427672947204369225600\nЧисло x по основанию b:  42400113461140240012472334196439388522112330925371811138538811167277139032661209098614732494153224551313340165617173622406110992999241362032831188185613283343189631323860332020653898279724471390933318733871627943189321025347131802111283655113717833902253041722501971262080420234002534233034643721263521461644373327032844249334712718373538172759199596970624172012296437911003268897420567423027226377330744049945305395516223463508273122623316270127802916784315734653698816755400022701311212724732995178235035061741223372113631233163218405226042796101237381521499193450313913194902232484155114843439214511991811917309339013932310326248869021502147340428564006729292521804851666273430601776172993026305982701255373411713065\nz = [b^2k / m] =  7271545900509188484641093905753810561467610124740601914810492278276280322352995258\n\n"}︡{"stdout":"r = x (mod m) = 42400113461140240012472334196439388522112330925371811138538811167277139032661209098614732494153224551313340165617173622406110992999241362032831188185613283343189631323860332020653898279724471390933318733871627943189321025347131802111283655113717833902253041722501971262080420234002534233034643721263521461644373327032844249334712718373538172759199596970624172012296437911003268897420567423027226377330744049945305395516223463508273122623316270127802916784315734653698816755400022701311212724732995178235035061741223372113631233163218405226042796101237381521499193450313913194902232484155114843439214511991811917309339013932310326248869021502147340428564006729292521804851666273430601776172993026305982701255373411713065 (mod 7202629322971168209199619831696273371024021461138427672947204369225600 ) = 1991116680597111374083179625337900407809067675889699666280193206813737\n"}︡{"stdout":"\nCPU time: 422.14 s, Wall time: 441.57 s\n"}︡{"done":true}{"stdout":"Основание b =  4096\nМодуль m по основани b:  7202629322971168209199619831696273371024021461138427672947204369225600\nЧисло x по основанию b:  42400113461140240012472334196439388522112330925371811138538811167277139032661209098614732494153224551313340165617173622406110992999241362032831188185613283343189631323860332020653898279724471390933318733871627943189321025347131802111283655113717833902253041722501971262080420234002534233034643721263521461644373327032844249334712718373538172759199596970624172012296437911003268897420567423027226377330744049945305395516223463508273122623316270127802916784315734653698816755400022701311212724732995178235035061741223372113631233163218405226042796101237381521499193450313913194902232484155114843439214511991811917309339013932310326248869021502147340428564006729292521804851666273430601776172993026305982701255373411713065\nz = [b^2k / m] =  7271545900509188484641093905753810561467610124740601914810492278276280322352995258\n\n"}︡{"stdout":"r = x (mod m) = 42400113461140240012472334196439388522112330925371811138538811167277139032661209098614732494153224551313340165617173622406110992999241362032831188185613283343189631323860332020653898279724471390933318733871627943189321025347131802111283655113717833902253041722501971262080420234002534233034643721263521461644373327032844249334712718373538172759199596970624172012296437911003268897420567423027226377330744049945305395516223463508273122623316270127802916784315734653698816755400022701311212724732995178235035061741223372113631233163218405226042796101237381521499193450313913194902232484155114843439214511991811917309339013932310326248869021502147340428564006729292521804851666273430601776172993026305982701255373411713065 (mod 7202629322971168209199619831696273371024021461138427672947204369225600 ) = 1991116680597111374083179625337900407809067675889699666280193206813737\n"}︡{"stdout":"\nCPU time: 422.14 s, Wall time: 441.57 s\n"}︡{"done":true}︡
︠565491c3-8963-40ec-bb2a-1696b9ba9c17︠









